{
    "id": 12,
    "title": "Department Highest Salary",
    "difficulty": "Medium",
    "markdown": "\n# **Department Highest Salary**\n\n## Find employees who have the highest salary in each department.\n\n### Table Schema\n**Employee**: id, name, salary, departmentId\n**Department**: id, name\n\n### Example\n\n**Input:**\n```\n**Employee**\n+----+-------+--------+--------------+\n| id | name  | salary | departmentId |\n+----+-------+--------+--------------+\n| 1  | Joe   | 70000  | 1            |\n| 2  | Jim   | 90000  | 1            |\n| 3  | Henry | 80000  | 2            |\n| 4  | Sam   | 60000  | 2            |\n| 5  | Max   | 90000  | 1            |\n+----+-------+--------+--------------+\n\n**Department**\n+----+-------+\n| id | name  |\n+----+-------+\n| 1  | IT    |\n| 2  | Sales |\n+----+-------+\n```\n\n**Expected Output:**\n```\n+------------+----------+--------+\n| Department | Employee | Salary |\n+------------+----------+--------+\n| IT         | Jim      | 90000  |\n| Sales      | Henry    | 80000  |\n| IT         | Max      | 90000  |\n+------------+----------+--------+\n```\n",
    "testCases": [
        {
            "input": "Standard",
            "setupSql": "CREATE TABLE Employee(id INT, name TEXT, salary INT, departmentId INT); CREATE TABLE Department(id INT, name TEXT); INSERT INTO Department VALUES (1,'IT'),(2,'Sales'); INSERT INTO Employee VALUES (1,'Joe',70000,1),(2,'Jim',90000,1),(3,'Henry',80000,2),(4,'Sam',60000,2),(5,'Max',90000,1);",
            "solutionSql": "SELECT d.name AS Department, e.name AS Employee, e.salary AS Salary FROM Employee e JOIN Department d ON e.departmentId = d.id WHERE (e.departmentId, e.salary) IN (SELECT departmentId, MAX(salary) FROM Employee GROUP BY departmentId);"
        },
        {
            "input": "Single Dept",
            "setupSql": "CREATE TABLE Employee(id INT, name TEXT, salary INT, departmentId INT); CREATE TABLE Department(id INT, name TEXT); INSERT INTO Department VALUES (1,'IT'); INSERT INTO Employee VALUES (1,'Joe',70000,1),(2,'Jim',90000,1);",
            "solutionSql": "SELECT d.name AS Department, e.name AS Employee, e.salary AS Salary FROM Employee e JOIN Department d ON e.departmentId = d.id WHERE (e.departmentId, e.salary) IN (SELECT departmentId, MAX(salary) FROM Employee GROUP BY departmentId);"
        },
        {
            "input": "Empty",
            "setupSql": "CREATE TABLE Employee(id INT, name TEXT, salary INT, departmentId INT); CREATE TABLE Department(id INT, name TEXT);",
            "solutionSql": "SELECT d.name AS Department, e.name AS Employee, e.salary AS Salary FROM Employee e JOIN Department d ON e.departmentId = d.id WHERE (e.departmentId, e.salary) IN (SELECT departmentId, MAX(salary) FROM Employee GROUP BY departmentId);"
        }
    ]
}