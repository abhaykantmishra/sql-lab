{
    "id": 12,
    "title": "Department Highest Salary",
    "difficulty": "Medium",
    "tags": [
        "JOIN",
        "SUBQUERY",
        "GROUP BY"
    ],
    "markdown": "# **Department Highest Salary**\n\n**Difficulty:** Medium  \u2022  **Tags:** `JOIN` \u2022 `SUBQUERY` \u2022 `GROUP BY`\n\n\n\n## **Problem Description**\n\nFind employees who have the highest salary in each department.\n\n\n\n## **Table Schema**\n\n**employees**\n```\n+---------------+------+\n| Column        | Type |\n+---------------+------+\n| id            | INT  |\n| name          | TEXT |\n| salary        | INT  |\n| department_id | INT  |\n+---------------+------+\n```\n\n**departments**\n```\n+--------+------+\n| Column | Type |\n+--------+------+\n| id     | INT  |\n| name   | TEXT |\n+--------+------+\n```\n\n\n\n## **Example**\n\n### **Input**\n\n**employees**\n```\n+----+-------+--------+---------------+\n| id | name  | salary | department_id |\n+----+-------+--------+---------------+\n| 1  | Joe   | 70000  | 1             |\n| 2  | Jim   | 90000  | 1             |\n| 3  | Henry | 80000  | 2             |\n| 4  | Sam   | 60000  | 2             |\n| 5  | Max   | 90000  | 1             |\n+----+-------+--------+---------------+\n```\n\n**departments**\n```\n+----+-------+\n| id | name  |\n+----+-------+\n| 1  | IT    |\n| 2  | Sales |\n+----+-------+\n```\n\n### **Expected Output**\n\n```\n+------------+----------+--------+\n| Department | Employee | Salary |\n+------------+----------+--------+\n| IT         | Jim      | 90000  |\n| Sales      | Henry    | 80000  |\n| IT         | Max      | 90000  |\n+------------+----------+--------+\n```\n",
    "testCases": [
        {
            "input": "Standard",
            "setupSql": "CREATE TABLE employees(id INT, name TEXT, salary INT, department_id INT); CREATE TABLE departments(id INT, name TEXT); INSERT INTO departments VALUES (1,'IT'),(2,'Sales'); INSERT INTO employees VALUES (1,'Joe',70000,1),(2,'Jim',90000,1),(3,'Henry',80000,2),(4,'Sam',60000,2),(5,'Max',90000,1);",
            "solutionSql": "SELECT d.name as Department, e.name as Employee, e.salary as Salary FROM employees e JOIN departments d ON e.department_id = d.id WHERE (e.department_id, e.salary) IN (SELECT department_id, MAX(salary) FROM employees GROUP BY department_id);"
        },
        {
            "input": "Empty",
            "setupSql": "CREATE TABLE employees(id INT, name TEXT, salary INT, department_id INT);",
            "solutionSql": "SELECT d.name as Department, e.name as Employee, e.salary as Salary FROM employees e JOIN departments d ON e.department_id = d.id WHERE (e.department_id, e.salary) IN (SELECT department_id, MAX(salary) FROM employees GROUP BY department_id);"
        },
        {
            "input": "Large",
            "setupSql": "CREATE TABLE employees(id INT, name TEXT, salary INT, department_id INT); CREATE TABLE departments(id INT, name TEXT); INSERT INTO departments VALUES (1,'IT'),(2,'Sales'); INSERT INTO employees VALUES (1,'Joe',70000,1),(2,'Jim',90000,1),(3,'Henry',80000,2),(4,'Sam',60000,2),(5,'Max',90000,1);",
            "solutionSql": "SELECT d.name as Department, e.name as Employee, e.salary as Salary FROM employees e JOIN departments d ON e.department_id = d.id WHERE (e.department_id, e.salary) IN (SELECT department_id, MAX(salary) FROM employees GROUP BY department_id);"
        }
    ]
}