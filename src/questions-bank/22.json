{
    "id": 22,
    "title": "Employee Hierarchy",
    "difficulty": "Hard",
    "tags": [
        "SELF JOIN",
        "RECURSIVE"
    ],
    "markdown": "# **Employee Hierarchy**\n\n**Difficulty:** Hard  \u2022  **Tags:** `SELF JOIN` \u2022 `RECURSIVE`\n\n\n\n## **Problem Description**\n\nFind all employees who report to a specific manager (direct and indirect reports).\n\n\n\n## **Table Schema**\n\n**employees**\n```\n+------------+------+\n| Column     | Type |\n+------------+------+\n| id         | INT  |\n| name       | TEXT |\n| manager_id | INT  |\n+------------+------+\n```\n\n\n\n## **Example**\n\n### **Input**\n\n**employees**\n```\n+----+---------+------------+\n| id | name    | manager_id |\n+----+---------+------------+\n| 1  | CEO     | None       |\n| 2  | VP      | 1          |\n| 3  | Manager | 2          |\n| 4  | Dev     | 3          |\n+----+---------+------------+\n```\n\n### **Expected Output**\n\n```\n+---------+\n| name    |\n+---------+\n| VP      |\n| Manager |\n+---------+\n```\n",
    "testCases": [
        {
            "input": "Standard",
            "setupSql": "CREATE TABLE employees(id INT, name TEXT, manager_id INT); INSERT INTO employees VALUES (1,'CEO',NULL),(2,'VP',1),(3,'Manager',2),(4,'Dev',3);",
            "solutionSql": "SELECT name FROM employees WHERE manager_id = 1 OR manager_id IN (SELECT id FROM employees WHERE manager_id = 1);"
        },
        {
            "input": "Empty",
            "setupSql": "CREATE TABLE employees(id INT, name TEXT, manager_id INT);",
            "solutionSql": "SELECT name FROM employees WHERE manager_id = 1 OR manager_id IN (SELECT id FROM employees WHERE manager_id = 1);"
        },
        {
            "input": "Large",
            "setupSql": "CREATE TABLE employees(id INT, name TEXT, manager_id INT); INSERT INTO employees VALUES (1,'CEO',NULL),(2,'VP',1),(3,'Manager',2),(4,'Dev',3);",
            "solutionSql": "SELECT name FROM employees WHERE manager_id = 1 OR manager_id IN (SELECT id FROM employees WHERE manager_id = 1);"
        }
    ]
}