{
    "id": 25,
    "title": "Nth Order Per Customer",
    "difficulty": "Hard",
    "tags": [
        "WINDOW FUNCTION",
        "ROW_NUMBER"
    ],
    "markdown": "# **Nth Order Per Customer**\n\n**Difficulty:** Hard  \u2022  **Tags:** `WINDOW FUNCTION` \u2022 `ROW_NUMBER`\n\n\n\n## **Problem Description**\n\nFind the 2nd order for each customer.\n\n\n\n## **Table Schema**\n\n**customers**\n```\n+--------+------+\n| Column | Type |\n+--------+------+\n| id     | INT  |\n| name   | TEXT |\n+--------+------+\n```\n\n**orders**\n```\n+-------------+------+\n| Column      | Type |\n+-------------+------+\n| id          | INT  |\n| customer_id | INT  |\n| order_date  | DATE |\n+-------------+------+\n```\n\n\n\n## **Example**\n\n### **Input**\n\n**customers**\n```\n+----+-------+\n| id | name  |\n+----+-------+\n| 1  | Alice |\n| 2  | Bob   |\n+----+-------+\n```\n\n**orders**\n```\n+----+-------------+------------+\n| id | customer_id | order_date |\n+----+-------------+------------+\n| 1  | 1           | 2023-01-01 |\n| 2  | 1           | 2023-01-05 |\n| 3  | 1           | 2023-01-10 |\n| 4  | 2           | 2023-01-02 |\n| 5  | 2           | 2023-01-08 |\n+----+-------------+------------+\n```\n\n### **Expected Output**\n\n```\n+----+-------------+------------+----+\n| id | customer_id | order_date | rn |\n+----+-------------+------------+----+\n| 2  | 1           | 2023-01-05 | 2  |\n| 5  | 2           | 2023-01-08 | 2  |\n+----+-------------+------------+----+\n```\n",
    "testCases": [
        {
            "input": "Standard",
            "setupSql": "CREATE TABLE customers(id INT, name TEXT); CREATE TABLE orders(id INT, customer_id INT, order_date DATE); INSERT INTO customers VALUES (1,'Alice'),(2,'Bob'); INSERT INTO orders VALUES (1,1,'2023-01-01'),(2,1,'2023-01-05'),(3,1,'2023-01-10'),(4,2,'2023-01-02'),(5,2,'2023-01-08');",
            "solutionSql": "SELECT * FROM (SELECT o.*, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY order_date) as rn FROM orders o) WHERE rn = 2;"
        },
        {
            "input": "Empty",
            "setupSql": "CREATE TABLE customers(id INT, name TEXT);",
            "solutionSql": "SELECT * FROM (SELECT o.*, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY order_date) as rn FROM orders o) WHERE rn = 2;"
        },
        {
            "input": "Large",
            "setupSql": "CREATE TABLE customers(id INT, name TEXT); CREATE TABLE orders(id INT, customer_id INT, order_date DATE); INSERT INTO customers VALUES (1,'Alice'),(2,'Bob'); INSERT INTO orders VALUES (1,1,'2023-01-01'),(2,1,'2023-01-05'),(3,1,'2023-01-10'),(4,2,'2023-01-02'),(5,2,'2023-01-08');",
            "solutionSql": "SELECT * FROM (SELECT o.*, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY order_date) as rn FROM orders o) WHERE rn = 2;"
        }
    ]
}