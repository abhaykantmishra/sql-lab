{
    "id": 16,
    "title": "Average Order Value",
    "difficulty": "Easy",
    "tags": [
        "AVG",
        "JOIN"
    ],
    "markdown": "# **Average Order Value**\n\n**Difficulty:** Easy  \u2022  **Tags:** `AVG` \u2022 `JOIN`\n\n\n\n## **Problem Description**\n\nCalculate the average order value for each customer.\n\n\n\n## **Table Schema**\n\n**customers**\n```\n+--------+------+\n| Column | Type |\n+--------+------+\n| id     | INT  |\n| name   | TEXT |\n+--------+------+\n```\n\n**orders**\n```\n+-------------+------+\n| Column      | Type |\n+-------------+------+\n| id          | INT  |\n| customer_id | INT  |\n| amount      | INT  |\n+-------------+------+\n```\n\n\n\n## **Example**\n\n### **Input**\n\n**customers**\n```\n+----+-------+\n| id | name  |\n+----+-------+\n| 1  | Alice |\n| 2  | Bob   |\n+----+-------+\n```\n\n**orders**\n```\n+----+-------------+--------+\n| id | customer_id | amount |\n+----+-------------+--------+\n| 1  | 1           | 100    |\n| 2  | 1           | 200    |\n| 3  | 2           | 150    |\n+----+-------------+--------+\n```\n\n### **Expected Output**\n\n```\n+-------+-----------+\n| name  | avg_order |\n+-------+-----------+\n| Alice | 150.0     |\n| Bob   | 150.0     |\n+-------+-----------+\n```\n",
    "testCases": [
        {
            "input": "Standard",
            "setupSql": "CREATE TABLE customers(id INT, name TEXT); CREATE TABLE orders(id INT, customer_id INT, amount INT); INSERT INTO customers VALUES (1,'Alice'),(2,'Bob'); INSERT INTO orders VALUES (1,1,100),(2,1,200),(3,2,150);",
            "solutionSql": "SELECT c.name, AVG(o.amount) as avg_order FROM customers c JOIN orders o ON c.id = o.customer_id GROUP BY c.id;"
        },
        {
            "input": "Empty",
            "setupSql": "CREATE TABLE customers(id INT, name TEXT);",
            "solutionSql": "SELECT c.name, AVG(o.amount) as avg_order FROM customers c JOIN orders o ON c.id = o.customer_id GROUP BY c.id;"
        },
        {
            "input": "Large",
            "setupSql": "CREATE TABLE customers(id INT, name TEXT); CREATE TABLE orders(id INT, customer_id INT, amount INT); INSERT INTO customers VALUES (1,'Alice'),(2,'Bob'); INSERT INTO orders VALUES (1,1,100),(2,1,200),(3,2,150);",
            "solutionSql": "SELECT c.name, AVG(o.amount) as avg_order FROM customers c JOIN orders o ON c.id = o.customer_id GROUP BY c.id;"
        }
    ]
}